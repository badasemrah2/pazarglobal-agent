| table_full_name                        | primary_keys | columns                                                                                                                                                                                                                                                                          | rls_policies                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| -------------------------------------- | ------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public.active_drafts                   | id           | id, user_id, state, listing_data, images, vision_product, created_at, updated_at                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.admin_actions                   | id           | id, admin_id, action, target_user, target_listing, details, created_at                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.audit_logs                      | id           | id, user_id, phone, action, resource_type, resource_id, source, ip_address, user_agent, request_data, response_status, error_message, metadata, created_at                                                                                                                       | Service role can insert audit logs(INSERT); Users can view own audit logs(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public.backup_profiles_full            |              | id, phone, email, full_name, display_name, avatar_url, location, user_role, is_verified, is_active, bio, preferences, metadata, created_at, updated_at, rating                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.backup_user_with_security_jsonb |              | payload                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.conversations                   | id           | id, user_id, platform, messages, created_at, updated_at                                                                                                                                                                                                                          | Service role full access to conversations(ALL); Users can create own conversations(INSERT); Users can create their own conversations(INSERT); Users can update their own conversations(UPDATE); Users can view own conversations(SELECT); Users can view their own conversations(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| public.favorites                       | id           | id, user_id, listing_id, created_at                                                                                                                                                                                                                                              | Kullanıcılar favori ekleyebilir(INSERT); Kullanıcılar favori silebilir(DELETE); Kullanıcılar kendi favorilerini görebilir(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public.illegal_reports                 | id           | id, reporter_user, listing_id, reason, evidence, reviewed, reviewed_by, reviewed_at, created_at                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.image_safety_flags              | id           | id, user_id, image_url, flag_type, confidence, message, status, created_at, reviewed_at, reviewer, notes                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.listings                        | id           | id, user_id, title, description, category, price, stock, location, status, created_at, updated_at, view_count, market_price_at_publish, last_price_check_at, condition, image_url, metadata, images, is_premium, user_name, user_phone, premium_until, premium_badge, expires_at | Authenticated users can delete own listings(DELETE); Authenticated users can insert own listings(INSERT); Authenticated users can update own listings(UPDATE); Authenticated users can view own listings(SELECT); Herkes ilanları görüntüleyebilir(SELECT); Kullanıcılar ilan oluşturabilir(INSERT); Kullanıcılar kendi ilanlarını güncelleyebilir(UPDATE); Kullanıcılar kendi ilanlarını silebilir(DELETE); Public can view active listings(SELECT); Public read access for active listings(SELECT); Service role can manage all listings(ALL); Service role full access to listings(ALL); Temporary test - public full access(ALL); Users can view their own listings(SELECT); authenticated_can_insert_listings(INSERT); insert_listings_owner(INSERT); owner_can_delete_own_listings(DELETE); owner_can_update_own_listings(UPDATE); public_can_view_active_listings(SELECT) |
| public.market_data_query_log           | id           | id, product_key, category, hit_type, response_time_ms, cost, created_at                                                                                                                                                                                                          | Query log readable by service(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| public.market_data_ttl_config          | id           | id, category, ttl_days, description, created_at, updated_at                                                                                                                                                                                                                      | TTL config is publicly readable(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| public.market_price_snapshots          | id           | id, product_key, original_title, category, condition, min_price, max_price, avg_price, currency, sources, confidence, query_count, last_query_at, created_at, last_updated_at, expires_at, raw_data, metadata                                                                    | Market data is publicly readable(SELECT); Only service role can write(ALL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public.notifications                   | id           | id, user_id, listing_id, type, title, message, metadata, is_read, created_at, read_at                                                                                                                                                                                            | Service role can create notifications(INSERT); Service role full access to notifications(ALL); Users can update their own notifications(UPDATE); Users can view their own notifications(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.orders                          | id           | id, listing_id, buyer_id, seller_id, price, commission, status, created_at, completed_at, quantity, seller_receives                                                                                                                                                              | Sellers can update order status(UPDATE); Service role full access to orders(ALL); Users can create orders(INSERT); Users can view orders as buyer(SELECT); Users can view orders as seller(SELECT); Users can view own orders(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| public.payments                        | id           | id, user_id, gateway, gateway_payment_id, amount_bigint, currency, status, metadata, created_at, updated_at                                                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.pin_verification_attempts       | id           | id, phone, attempt_time, success, ip_address, user_agent                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.product_embeddings              | id           | id, listing_id, embedding, created_at                                                                                                                                                                                                                                            | Anyone can read embeddings(SELECT); Service role full access to embeddings(ALL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.product_images                  | id           | id, listing_id, storage_path, public_url, is_primary, display_order, file_size, mime_type, width, height, created_at                                                                                                                                                             | Anyone can view product images(SELECT); Users can add images to own listings(INSERT); Users can delete own product images(DELETE)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| public.profiles                        | id           | id, phone, email, full_name, display_name, avatar_url, location, is_verified, is_active, bio, preferences, metadata, created_at, updated_at, rating, role                                                                                                                        | Herkes profilleri görüntüleyebilir(SELECT); Kullanıcılar kendi profillerini güncelleyebilir(UPDATE); Public profiles are viewable by everyone(SELECT); Users can delete own profile(DELETE); Users can insert own profile(INSERT); Users can update own profile(UPDATE); Users can view own profile(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public.rate_limits                     | id           | id, user_id, phone, action, count, window_start, window_end, max_allowed, created_at, updated_at                                                                                                                                                                                 | Service role can manage rate limits(ALL); Users can view own rate limits(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| public.user_security                   | id           | id, user_id, phone, pin_hash, session_token, session_expires_at, failed_attempts, blocked_until, last_login_at, last_login_ip, device_fingerprint, created_at, updated_at, is_locked                                                                                             | Service role can manage security(ALL); Users can read own security settings(SELECT); Users can update own security settings(UPDATE); Users can view own security data(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| public.user_sessions                   | id           | id, user_id, phone, session_token, is_active, expires_at, created_at, ended_at, session_type, last_activity, end_reason, ip_address, user_agent                                                                                                                                  | Users can read own sessions(SELECT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| public.wallet_transactions             | id           | id, user_id, amount_bigint, kind, reference, metadata, created_at                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| public.wallets                         | user_id      | user_id, balance_bigint, currency, updated_at                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
